#!/usr/bin/env node

const gitSync = require('../src/main.js')
const toObject = str => JSON.parse(str)
const toArray = str => str.split(',')
const toBoolean = str => str === 'true'

const copy = process.env.PLUGIN_COPY ? toArray(process.env.PLUGIN_COPY).map(pathset=>pathset.split(':')) : []

gitSync({
    cwd: process.env.PLUGIN_CWD || 'tmp',
    overwrite: toBoolean(process.env.PLUGIN_OVERWRITE),
    silent: toBoolean(process.env.PLUGIN_SILENT),
    copy,
    account: toObject(process.env.PLUGIN_GIT_ACCOUNT),
    config: toObject(process.env.PLUGIN_GIT_CONFIG),
    repository: toObject(process.env.PLUGIN_REPOSITORY),
    ssh: process.env.PLUGIN_GIT_SSH,
})